<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>Selecciona tus Plataformas - Paso 2</title>
    <link rel="stylesheet" href="../css/style.css"/>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    <style>
        .onboarding-container {
            max-width: 700px;
            margin: 50px auto;
            padding: 40px;
        }

        .step-indicator {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-bottom: 40px;
        }

        .step {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 500;
            margin: 0 10px;
            transition: all 0.3s ease;
        }

        .step.active {
            background: var(--color-blue);
            color: white;
        }

        .step.completed {
            background: #28a745;
            color: white;
        }

        .step.pending {
            background: var(--color-gray);
            color: #666;
        }

        .step-line {
            width: 60px;
            height: 2px;
            background: var(--color-gray);
            margin: 0 10px;
        }

        .step-line.completed {
            background: #28a745;
        }

        .step-content {
            text-align: center;
            margin-bottom: 40px;
        }

        .step-title {
            font-size: 28px;
            font-weight: 700;
            color: var(--color-black);
            margin-bottom: 12px;
        }

        .step-description {
            font-size: 16px;
            color: #666;
            line-height: 1.5;
        }

        .platforms-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 32px 0;
        }

        .platform-option {
            background: var(--color-white);
            border: 2px solid var(--color-gray);
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .platform-option:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
        }

        .platform-option.selected {
            border-color: var(--color-blue);
            background: rgba(0, 145, 255, 0.05);
        }

        .platform-option.selected::after {
            content: '‚úì';
            position: absolute;
            top: 10px;
            right: 10px;
            width: 24px;
            height: 24px;
            background: var(--color-blue);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
        }

        .platform-icon {
            font-size: 32px;
            margin-bottom: 12px;
        }

        .platform-name {
            font-size: 16px;
            font-weight: 500;
            color: var(--color-black);
            margin-bottom: 4px;
        }

        .platform-desc {
            font-size: 12px;
            color: #666;
            line-height: 1.3;
        }

        .selection-counter {
            text-align: center;
            margin: 20px 0;
            font-size: 14px;
            color: #666;
        }

        .onboarding-actions {
            display: flex;
            gap: 16px;
            justify-content: space-between;
            margin-top: 40px;
        }

        .btn-back {
            background: transparent;
            color: #666;
            border: 1px solid var(--color-gray);
        }

        .btn-back:hover {
            background: var(--color-gray);
        }

        .btn-continue {
            min-width: 140px;
        }

        @media (max-width: 768px) {
            .onboarding-container {
                padding: 20px;
                margin: 20px auto;
            }

            .platforms-grid {
                grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
                gap: 12px;
            }

            .platform-option {
                padding: 16px;
            }

            .platform-icon {
                font-size: 28px;
            }

            .onboarding-actions {
                flex-direction: column;
            }
        }
    </style>
</head>
<body class="auth-bg">
    <div class="onboarding-container">
        <!-- Indicador de progreso -->
        <div class="step-indicator">
            <div class="step completed">1</div>
            <div class="step-line completed"></div>
            <div class="step active">2</div>
            <div class="step-line"></div>
            <div class="step pending">3</div>
            <div class="step-line"></div>
            <div class="step pending">4</div>
        </div>

        <!-- Contenido del paso -->
        <div class="step-content">
            <h1 class="step-title">¬øEn qu√© plataformas quieres estar activo?</h1>
            <p class="step-description">
                Selecciona las redes sociales donde quieres que Roastr.ai genere respuestas autom√°ticas. 
                Puedes conectar m√°s plataformas despu√©s desde tu dashboard.
            </p>
        </div>

        <!-- Grid de plataformas -->
        <div class="platforms-grid" id="platforms-grid">
            <!-- Se llenar√° din√°micamente -->
        </div>

        <!-- Contador de selecci√≥n -->
        <div class="selection-counter">
            <span id="selection-count">0</span> plataformas seleccionadas (puedes seleccionar todas las que quieras)
        </div>

        <!-- Mensajes de estado -->
        <div id="error-message" class="error-message"></div>
        <div id="success-message" class="success-message"></div>

        <!-- Botones de navegaci√≥n -->
        <div class="onboarding-actions">
            <button class="btn-secondary btn-back" onclick="previousStep()">‚Üê Anterior</button>
            <button class="btn-primary btn-continue" onclick="nextStep()">Continuar ‚Üí</button>
        </div>
    </div>

    <script>
        // Configuraci√≥n de plataformas
        const platformsConfig = {
            twitter: { name: 'Twitter/X', icon: 'ùïè', desc: 'Respuestas autom√°ticas a menciones' },
            instagram: { name: 'Instagram', icon: 'üì∑', desc: 'Comentarios en posts y stories' },
            facebook: { name: 'Facebook', icon: 'üë§', desc: 'Respuestas en posts y p√°ginas' },
            youtube: { name: 'YouTube', icon: '‚ñ∂Ô∏è', desc: 'Comentarios en videos' },
            discord: { name: 'Discord', icon: 'üéÆ', desc: 'Bot activo en servidores' },
            twitch: { name: 'Twitch', icon: 'üé•', desc: 'Chatbot para streams' },
            reddit: { name: 'Reddit', icon: 'ü§ñ', desc: 'Respuestas en subreddits' },
            tiktok: { name: 'TikTok', icon: 'üéµ', desc: 'Comentarios en videos' },
            bluesky: { name: 'Bluesky', icon: '‚òÅÔ∏è', desc: 'Red social descentralizada' }
        };

        let selectedPlatforms = new Set();

        // Verificar autenticaci√≥n
        document.addEventListener('DOMContentLoaded', function() {
            const token = localStorage.getItem('auth_token');
            
            if (!token) {
                window.location.href = '/auth.html';
                return;
            }

            renderPlatforms();
        });

        function renderPlatforms() {
            const grid = document.getElementById('platforms-grid');
            
            const platformsHTML = Object.entries(platformsConfig).map(([key, config]) => {
                return `
                    <div class="platform-option" data-platform="${key}" onclick="togglePlatform('${key}')">
                        <div class="platform-icon">${config.icon}</div>
                        <div class="platform-name">${config.name}</div>
                        <div class="platform-desc">${config.desc}</div>
                    </div>
                `;
            }).join('');
            
            grid.innerHTML = platformsHTML;
            updateSelectionCounter();
        }

        function togglePlatform(platform) {
            const element = document.querySelector(`[data-platform="${platform}"]`);
            
            if (selectedPlatforms.has(platform)) {
                selectedPlatforms.delete(platform);
                element.classList.remove('selected');
            } else {
                selectedPlatforms.add(platform);
                element.classList.add('selected');
            }
            
            updateSelectionCounter();
        }

        function updateSelectionCounter() {
            const counter = document.getElementById('selection-count');
            counter.textContent = selectedPlatforms.size;
        }

        function previousStep() {
            window.location.href = '/onboarding/step1.html';
        }

        function nextStep() {
            // Guardar selecci√≥n en sessionStorage para el siguiente paso
            sessionStorage.setItem('selected_platforms', JSON.stringify([...selectedPlatforms]));
            window.location.href = '/onboarding/step3.html';
        }

        function showMessage(message, type = 'error') {
            const errorDiv = document.getElementById('error-message');
            const successDiv = document.getElementById('success-message');
            
            errorDiv.classList.remove('show');
            successDiv.classList.remove('show');
            
            if (type === 'error') {
                errorDiv.textContent = message;
                errorDiv.classList.add('show');
            } else {
                successDiv.textContent = message;
                successDiv.classList.add('show');
            }
            
            setTimeout(() => {
                errorDiv.classList.remove('show');
                successDiv.classList.remove('show');
            }, 5000);
        }
    </script>
</body>
</html>