# Plan: CodeRabbit Review #3268066114 - PR #424

## 📋 **Resumen de Comentarios CodeRabbit**

### ❌ **Problemas Críticos Identificados**

1. **Missing Adapters/Routes**
   - Importaciones para adapters de Instagram y Facebook no existen
   - Tests E2E apuntan a rutas de API que no están implementadas

2. **Problemas de Dependencias y Configuración**
   - `jest-html-reporters` falta en `package.json`
   - Claves Stripe hardcodeadas en GitHub workflow (activará secret scanners)
   - Claves de configuración duplicadas en Jest config

3. **Issues de Mocking y Setup de Tests**
   - Mock de Supabase incorrectamente añade método "then" al client
   - Mock de Perspective depende de keywords en español no presentes en fixtures
   - Configuraciones de mock duplicadas entre archivos de test

## 🎯 **Objetivos del Plan**

1. **Resolver conflictos en PR #424**
2. **Implementar adapters y rutas faltantes**
3. **Arreglar configuraciones y dependencias**
4. **Mejorar sistema de mocking**
5. **Consolidar setup de tests**

## 👥 **Subagentes a Utilizar**

### 1. **GitHub Guardian**
- Resolver conflictos de la PR #424
- Arreglar configuraciones de GitHub Actions
- Gestionar secrets y variables de entorno

### 2. **Test Engineer**  
- Crear adapters faltantes (Instagram, Facebook)
- Implementar rutas de API missing
- Arreglar configuraciones de Jest
- Mejorar mocks de Supabase y Perspective
- Consolidar setup de tests

### 3. **Front-end Dev** (si aplica)
- Verificar integración frontend con nuevas rutas
- Ajustar configuraciones de cliente

### 4. **UI Designer** (si aplica)
- Revisar interfaces relacionadas con nuevos adapters

## 📁 **Archivos Afectados**

### **Configuración y Dependencias**
- `package.json` - Añadir `jest-html-reporters`
- `jest.spec14.config.js` - Limpiar duplicados
- `.github/workflows/spec14-qa-test-suite.yml` - Usar GitHub Secrets

### **Adapters Faltantes (a crear)**
- `src/adapters/InstagramAdapter.js`
- `src/adapters/FacebookAdapter.js`

### **Rutas API Faltantes (a crear)**
- Rutas específicas referenciadas en tests E2E

### **Tests a Arreglar**
- `tests/integration/spec14-adapter-contracts.test.js`
- `tests/e2e/spec14-integral-test-suite.test.js`
- `tests/helpers/syntheticFixtures.js`

### **Mocks a Mejorar**
- Configuraciones de Supabase mock
- Configuraciones de Perspective mock

## 🚀 **Fases de Implementación**

### **Fase 1: Resolución de Conflictos y Setup**
1. Resolver conflictos en PR #424
2. Actualizar `package.json` con dependencias faltantes
3. Arreglar GitHub Actions con secrets

### **Fase 2: Implementación de Componentes Faltantes**
1. Crear adapters de Instagram y Facebook
2. Implementar rutas de API faltantes
3. Usar **Test Engineer** para asegurar implementación correcta

### **Fase 3: Mejora de Mocking y Tests**
1. Arreglar mocks de Supabase (remover método "then")
2. Mejorar mock de Perspective con keywords apropiados
3. Consolidar configuraciones de test

### **Fase 4: Validación y Cleanup**
1. Ejecutar suite completa de tests
2. Verificar que no hay duplicados o configuraciones problemáticas
3. Generar evidencias con **Test Engineer**

## 🎯 **Criterios de Aceptación**

### **Funcionales**
- [ ] Todos los adapters importados existen y funcionan
- [ ] Todas las rutas API referenciadas están implementadas
- [ ] Suite de tests pasa completamente
- [ ] No hay claves hardcodeadas en workflows

### **Técnicos**
- [ ] Dependencias correctas en `package.json`
- [ ] Mocks funcionan correctamente sin errores
- [ ] Configuraciones de Jest limpias sin duplicados
- [ ] GitHub Secrets configurados apropiadamente

### **Calidad**
- [ ] Tests tienen cobertura adecuada
- [ ] No hay warnings o errors en ejecución
- [ ] Documentación actualizada si es necesario
- [ ] `spec.md` actualizado con cambios del sistema

## 📊 **Impacto en el Sistema**

- **Alto**: Nuevos adapters y rutas API
- **Medio**: Configuraciones de testing mejoradas  
- **Bajo**: Cleanup de duplicados y mocks

## ⚡ **Próximos Pasos**

1. **Empezar con GitHub Guardian** para resolver conflictos
2. **Usar Test Engineer** para implementar componentes faltantes
3. **Validar con todos los subagentes** que la implementación es correcta
4. **Actualizar spec.md** con nuevos componentes del sistema
5. **Commit y push** con changelog detallado

---

**Fecha de Creación**: 2025-09-25  
**Estimación**: 2-3 horas de implementación  
**Riesgo**: Medio (nuevos componentes pero bien definidos)