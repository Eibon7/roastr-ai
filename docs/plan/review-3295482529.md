# Implementation Plan: CodeRabbit Review #3295482529

## Review Information
- **Review ID**: 3295482529
- **PR**: #447 - docs: Reconcile roast limits in spec.md - Issue #446
- **Date**: 2025-10-02
- **Status**: Planning

## Problem Statement

CodeRabbit has identified remaining spec/code mismatches after the previous implementation (Review #3295440971). While `entitlementsService.js` was updated, other configuration files still contain outdated limit values.

### Current State Analysis

**spec.md (CORRECT - already updated):**
- Free: 100 análisis, 10 roasts
- Starter: 1,000 análisis, 10 roasts
- Pro: 10,000 análisis, 1,000 roasts
- Plus: 100,000 análisis, 5,000 roasts

**entitlementsService.js (CORRECT - updated in previous review):**
- Free: 100 análisis, 10 roasts ✓
- Starter: 1,000 análisis, 10 roasts ✓
- Pro: 10,000 análisis, 1,000 roasts ✓
- Plus: 100,000 análisis, 5,000 roasts ✓

**tierConfig.js (INCORRECT - needs update):**
- Free: monthlyAnalysisLimit: 100, maxRoasts: 10 ✓
- Starter: monthlyAnalysisLimit: 1000 ✓, maxRoasts: **50** ❌ (should be 10)
- Pro: monthlyAnalysisLimit: 10000 ✓, maxRoasts: 1000 ✓
- Plus: monthlyAnalysisLimit: 100000 ✓, maxRoasts: 5000 ✓

**creditsService.js (TBD - needs verification):**
- Need to check for hardcoded limit values

## CodeRabbit Feedback Summary

### Critical Issue: tierConfig.js Mismatch
**File**: `src/config/tierConfig.js`
**Line**: 182 (Starter plan maxRoasts)
**Issue**: Starter plan has `maxRoasts: 50` instead of `maxRoasts: 10`
**Severity**: HIGH
**Impact**: Incorrect limit enforcement for Starter plan users

### Potential Issue: creditsService.js
**File**: `src/services/creditsService.js`
**Issue**: May contain hardcoded limit values that need alignment
**Severity**: MEDIUM (pending verification)

### Test Expectations
**Files**: Test files
**Issue**: Tests may expect old values and need update after code changes
**Severity**: MEDIUM

## Implementation Strategy

### Phase 1: Configuration File Updates

#### 1.1 Update tierConfig.js
**File**: `src/config/tierConfig.js`
**Location**: Line 182 (Starter plan configuration)
**Change**:
```javascript
// BEFORE
starter: {
    maxRoasts: 50,
    monthlyResponsesLimit: 50,
    monthlyAnalysisLimit: 1000,
    // ...
}

// AFTER
starter: {
    maxRoasts: 10,
    monthlyResponsesLimit: 10,
    monthlyAnalysisLimit: 1000,
    // ...
}
```

#### 1.2 Verify and Update creditsService.js
**File**: `src/services/creditsService.js`
**Action**: Search for any hardcoded limit values and update if found
**Expected Changes**: TBD based on file contents

### Phase 2: Test Updates
Update any tests that validate tierConfig values:
- Search for tests referencing tierConfig
- Update assertions to match new values
- Ensure test coverage for Starter plan limits

### Phase 3: Documentation Updates
- Update changelog with tierConfig fixes
- Verify spec.md remains consistent (already correct)
- Document complete file list with limit values

## Files Affected

### Configuration Files (Code Changes)
1. `src/config/tierConfig.js` - Starter plan maxRoasts: 50 → 10
2. `src/services/creditsService.js` (if applicable)

### Test Files (Expected Updates)
- Any tests that reference tierConfig.TIER_LIMITS.starter.maxRoasts
- Any tests that validate Starter plan roast limits

### Documentation Files
1. `docs/CHANGELOG_ISSUE_443.md` - Add tierConfig fixes
2. `docs/plan/review-3295482529.md` - This implementation plan

## Subagents Required

1. **None** - Simple configuration value updates
   - Direct file edits
   - Test updates if needed

## Success Criteria

- [ ] tierConfig.js Starter plan has maxRoasts: 10
- [ ] tierConfig.js Starter plan has monthlyResponsesLimit: 10
- [ ] creditsService.js verified (no hardcoded limits or all updated)
- [ ] All tests pass with updated values
- [ ] Changelog updated with tierConfig changes
- [ ] CodeRabbit review satisfied (no spec/code mismatch)

## Risk Assessment

**Low Risk**: Configuration value changes only
**Testing Required**: Run affected tests to validate
**Rollback Plan**: Revert commit if tests fail

## Expected Changes Summary

**Starter Plan Updates:**
- `maxRoasts`: 50 → 10
- `monthlyResponsesLimit`: 50 → 10 (likely)
- Analysis limit already correct (1000)

**Other Plans:**
- No changes needed (already aligned with spec)

## Timeline

1. Configuration updates: 5 minutes
2. creditsService verification: 5 minutes
3. Test updates (if needed): 5 minutes
4. Verification and commit: 5 minutes

**Total Estimated Time**: 20 minutes

## Notes

- Previous review (#3295440971) updated entitlementsService.js successfully
- This review catches remaining config files missed in first pass
- CodeRabbit is ensuring complete consistency across entire codebase
- Starter plan is the only affected tier (others already correct)

---

**Plan Status**: ✅ Complete - Ready for Implementation
**Next Step**: Execute Phase 1 (Configuration File Updates)
