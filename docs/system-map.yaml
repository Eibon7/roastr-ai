# Roastr System Map - Graph Driven Development
# Version: 2.0.0
# Description: Complete dependency graph with bidirectional relationships
# Owner: Documentation Agent
# Last Updated: 2025-10-06

# Metadata
metadata:
  version: 2.0.0
  created: 2025-10-03
  last_updated: 2025-10-12
  total_nodes: 15
  critical_nodes: 9
  high_priority_nodes: 4
  production_nodes: 14
  development_nodes: 1
  pr: "#515"
  changes: "Added observability node (Issue #417 - structured logging and correlation)"
  protected: true
  last_verified: 2025-10-12
  protection_reason: "GDD 2.0 Maintenance Mode - Phase 18 Operational Freeze"

# Node Definitions
nodes:
  # Core Feature Nodes
  roast:
    description: Core roast generation system with AI prompts and quality control
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 85
    depends_on:
      - persona
      - tone
      - platform-constraints
      - shield
      - cost-control
      - observability
    used_by:
      - analytics
      - trainer
    docs:
      - docs/nodes/roast.md
    files:
      - src/services/roastEngine.js
      - src/services/roastGeneratorEnhanced.js
      - src/services/roastPromptTemplate.js
      - src/services/csvRoastService.js

  shield:
    description: Automated content moderation with escalating actions
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 78
    depends_on:
      - cost-control
      - queue-system
      - observability
    used_by:
      - roast
      - trainer
      - analytics
    docs:
      - docs/nodes/shield.md
    files:
      - src/services/shieldService.js
      - src/services/shieldDecisionEngine.js
      - src/services/shieldActionExecutor.js
      - src/workers/ShieldActionWorker.js

  # Infrastructure Nodes
  queue-system:
    description: Unified Redis/Upstash + Database queue management
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 87
    depends_on:
      - multi-tenant
      - observability
    used_by:
      - shield
      - social-platforms
      - billing
    docs:
      - docs/nodes/queue-system.md
    files:
      - src/services/queueService.js
      - src/workers/BaseWorker.js

  observability:
    description: Structured logging, correlation tracking, and end-to-end request tracing
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-12
    coverage: 10
    depends_on: []
    used_by:
      - queue-system
      - shield
      - multi-tenant
      - cost-control
      - social-platforms
      - roast
      - billing
      - analytics
    docs:
      - docs/nodes/observability.md
    files:
      - src/utils/advancedLogger.js
      - src/workers/BaseWorker.js
      - src/services/queueService.js
      - src/workers/FetchCommentsWorker.js
      - src/workers/AnalyzeToxicityWorker.js
      - src/workers/GenerateReplyWorker.js
      - src/workers/ShieldActionWorker.js
    tests:
      - tests/integration/test-observability.test.js

  multi-tenant:
    description: Row Level Security (RLS) and organization isolation
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 72
    depends_on:
      - observability
    used_by:
      - queue-system
      - cost-control
      - plan-features
      - billing
      - analytics
      - social-platforms
    docs:
      - docs/nodes/multi-tenant.md
    files:
      - database/schema.sql

  # Business Logic Nodes
  cost-control:
    description: Usage tracking, billing integration, and limit enforcement
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 68
    depends_on:
      - multi-tenant
      - plan-features
      - observability
    used_by:
      - roast
      - shield
      - billing
      - analytics
      - social-platforms
    docs:
      - docs/nodes/cost-control.md
    files:
      - src/services/costControl.js
      - src/services/usageTracker.js

  plan-features:
    description: Subscription plan feature gates and limits
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 70
    depends_on:
      - multi-tenant
    used_by:
      - cost-control
      - billing
      - persona
      - tone
    docs:
      - docs/nodes/plan-features.md
    files:
      - src/services/planLimitsService.js
      - src/services/entitlementsService.js

  billing:
    description: Stripe integration for subscriptions, webhooks, and plan management
    status: production
    priority: critical
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 65
    depends_on:
      - cost-control
      - queue-system
      - multi-tenant
      - plan-features
      - observability
    used_by:
      - analytics
    docs:
      - docs/nodes/billing.md
    files:
      - src/services/billingService.js
      - src/services/stripeService.js

  # Configuration Nodes
  persona:
    description: User personality and roast style configuration
    status: production
    priority: high
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 75
    depends_on:
      - plan-features
    used_by:
      - roast
      - tone
    docs:
      - docs/nodes/persona.md
    files:
      - src/services/personaService.js

  tone:
    description: Tone mapping and humor type configuration
    status: production
    priority: high
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 73
    depends_on:
      - persona
      - plan-features
    used_by:
      - roast
    docs:
      - docs/nodes/tone.md
    files:
      - src/services/toneService.js

  platform-constraints:
    description: Platform-specific character limits and style guides
    status: production
    priority: high
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 80
    depends_on:
      - social-platforms
    used_by:
      - roast
    docs:
      - docs/nodes/platform-constraints.md
    files:
      - src/services/platformConstraints.js

  social-platforms:
    description: 9 platform integrations (Twitter, YouTube, Instagram, etc.)
    status: production
    priority: high
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 82
    depends_on:
      - queue-system
      - cost-control
      - multi-tenant
      - observability
    used_by:
      - platform-constraints
      - analytics
    docs:
      - docs/nodes/social-platforms.md
    files:
      - src/integrations/twitter/twitterService.js
      - src/integrations/youtube/youtubeService.js
      - src/integrations/instagram/instagramService.js

  # Support Nodes
  analytics:
    description: Usage analytics, metrics, and reporting dashboard
    status: production
    priority: medium
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 60
    depends_on:
      - cost-control
      - multi-tenant
      - roast
      - shield
      - billing
      - social-platforms
      - observability
    used_by: []
    docs:
      - docs/nodes/analytics.md
    files:
      - src/services/analyticsService.js

  trainer:
    description: AI model fine-tuning and training data management
    status: development
    priority: medium
    owner: Back-end Dev
    last_updated: 2025-10-06
    coverage: 45
    depends_on:
      - roast
      - shield
    used_by: []
    docs:
      - docs/nodes/trainer.md
    files:
      - src/services/trainerService.js

  # Governance Nodes
  guardian:
    description: Product governance layer for monitoring and protecting sensitive changes
    status: production
    priority: critical
    owner: Product Owner
    last_updated: 2025-10-09
    coverage: 80
    depends_on: []
    used_by: []
    protected_domains:
      - pricing
      - quotas
      - auth_policies
      - ai_models
      - public_contracts
    docs:
      - docs/nodes/guardian.md
    files:
      - scripts/guardian-gdd.js
      - config/product-guard.yaml
      - config/guardian-ignore.yaml
    tests:
      - tests/unit/scripts/guardian-gdd.test.js

# Validation Rules
validation:
  bidirectional_check: true
  cycle_detection: true
  orphan_detection: true
  spec_sync_check: true
  coverage_threshold: 70
  update_freshness_days: 30
