# CodeRabbit Review #3447334692 - Plan

## üéØ FASE 0 - Assessment (OBLIGATORIO)

### 1. Lessons Learned

- [ ] Leer: `docs/patterns/coderabbit-lessons.md`
- [ ] Identificar patrones conocidos (‚â•2 comentarios = actualizar despu√©s)

### 2. GDD Nodes

```bash
# Detectar nodos autom√°ticamente
node scripts/cursor-agents/auto-gdd-activation.js --from-review 3447334692

# O manual basado en archivos:
# - logBackupService.js ‚Üí observability, queue-system
# - admin-plan-limits ‚Üí multi-tenant, cost-control
# - logCommands.test.js ‚Üí observability
```

**Nodos a cargar:**

- `docs/nodes/observability.md`
- `docs/nodes/multi-tenant.md`
- `docs/nodes/queue-system.md`

### 3. Agents Detection

```bash
node scripts/cursor-agents/detect-triggers.js
```

**Agentes esperados:**

- ‚úÖ TestEngineer (tests modificados)
- ‚úÖ Guardian (si hay cambios en RLS/security)

### 4. CodeRabbit Comments (Placeholder - completar con revisi√≥n real)

**‚ö†Ô∏è NOTA: Actualizar con comentarios reales de https://github.com/Eibon7/roastr-ai/pull/805#pullrequestreview-3447334692**

**Critical:** [count]

- [ ] TBD

**Major:** [count]

- [ ] TBD

**Minor:** [count]

- [ ] TBD

---

## üìã FASE 1 - Planning

### An√°lisis Inicial

**Archivos mencionados en review:**

- `tests/integration/cli/logCommands.test.js` (conflicto resuelto)
- `src/services/logBackupService.js`
- `tests/unit/services/logBackupService.test.js`
- `tests/unit/routes/admin-plan-limits.test.js`
- Otros seg√∫n revisi√≥n CodeRabbit

**Scope de Issue #774:**

- Fix pending tests for logBackupService
- Fix pending tests for admin-plan-limits
- Ensure 100% test passing
- Coverage ‚â•90%

### Estrategia

**Orden de aplicaci√≥n:**

1. Critical issues (security/data loss)
2. Major issues (architecture/bugs)
3. Minor issues (code quality/style)
4. Conflict resolution cleanup

**Commits:**

- Grupo 1: Critical fixes
- Grupo 2: Major fixes
- Grupo 3: Minor fixes + cleanup
- Grupo 4: Test evidence + docs

### GDD Updates

**Nodos a actualizar:**

- [ ] `observability.md` - Si cambia logBackupService
- [ ] `multi-tenant.md` - Si cambia admin-plan-limits
- [ ] A√±adir agents a "Agentes Relevantes" si se invocan

### Success Criteria

- [ ] 100% comentarios CodeRabbit resueltos (0 pending)
- [ ] Tests: 0 failures
- [ ] Coverage: ‚â•90%
- [ ] GDD health ‚â•87
- [ ] CodeRabbit re-review: 0 nuevos comentarios
- [ ] Completion validation: exit 0

---

## üîß FASE 2 - Aplicaci√≥n

### Checklist por Comentario

**Template (copiar para cada comentario):**

````markdown
#### Comentario #X - [Severity] - archivo:l√≠nea

**Issue:** [descripci√≥n]

**Root cause:** [causa ra√≠z]

**Fix:**

- [ ] Aplicar sugerencia
- [ ] Buscar patr√≥n en TODO el codebase
- [ ] Aplicar consistency
- [ ] Tests afectados
- [ ] GDD update si aplica

**Verification:**

```bash
# Comando para verificar
```
````

**Files:**

- Modified: [lista]
- Tests: [lista]

````

---

## ‚úÖ FASE 3 - Validaci√≥n

### Comandos de Verificaci√≥n (EJECUTAR TODOS)

```bash
# 1. Conflictos resueltos
grep -r "^<<<<<<<\|^=======\|^>>>>>>>" tests/integration/cli/logCommands.test.js
# Debe: No matches

# 2. Tests
npm test
# Debe: exit 0, 0 failures

# 3. Coverage
npm run test:coverage
# Debe: ‚â•90%

# 4. GDD Runtime
node scripts/validate-gdd-runtime.js --full
# Debe: üü¢ HEALTHY

# 5. GDD Health
node scripts/score-gdd-health.js --ci
# Debe: ‚â•87, exit 0

# 6. GDD Drift
node scripts/predict-gdd-drift.js --full
# Debe: <60 risk

# 7. CodeRabbit
npm run coderabbit:review
# Debe: 0 comentarios nuevos

# 8. Completion Validation
npm run validate:completion -- --pr=805
# Debe: exit 0 (100% complete)
````

### Evidencias

```bash
mkdir -p docs/test-evidence/review-3447334692

# Generar SUMMARY.md
# Template: docs/templates/SUMMARY-template.md
# Patr√≥n: Issues ‚Üí Fixes ‚Üí Testing ‚Üí Results (NO cronolog√≠a)
```

---

## üìù FASE 4 - Commit & Push

### Commit Template

```bash
git add .

git commit -m "fix: Apply CodeRabbit Review #3447334692 - Issue #774 fixes

### Issues Addressed (actualizar con reales)

- [Critical] Issue description (file:line)
- [Major] Issue description (file:line)
- [Minor] Issue description (file:line)

### Changes

- logBackupService: [cambios]
- admin-plan-limits: [cambios]
- logCommands.test.js: Resolved merge conflict + [cambios]

### Testing

- Added/Updated X tests
- Coverage: [before]% ‚Üí [after]%
- All tests passing (X/X)

### GDD

- Updated nodes: [lista o N/A]
- Health score: X (‚â•87 required)
- Agentes Relevantes: [lista o N/A]

### Agents

- Invoked: [lista o N/A]
- Receipts: docs/agents/receipts/cursor-*-[timestamp].md"

# Push (NO mergear)
git push origin fix/issue-774-pending-tests
```

---

## üìä Checklist Final

- [ ] Review #3447334692: X Critical, Y Major, Z Minor resueltos (100%)
- [ ] Conflicto logCommands.test.js resuelto
- [ ] N archivos modificados, M tests a√±adidos
- [ ] Coverage: A%‚ÜíB% (‚â•90%)
- [ ] Tests: 0 failures (verificado)
- [ ] GDD: Health ‚â•87, Drift <60 (verificado)
- [ ] spec.md: [secci√≥n o N/A]
- [ ] Evidencias: docs/test-evidence/review-3447334692/SUMMARY.md
- [ ] Receipts: docs/agents/receipts/cursor-\*-[timestamp].md
- [ ] CodeRabbit: 0 comentarios (re-verificado)
- [ ] Completion validation: exit 0
- [ ] Push confirmado: origin/fix/issue-774-pending-tests

---

## üîÑ Actualizar CodeRabbit Lessons

Si ‚â•2 comentarios = patr√≥n conocido:

1. Identificar patr√≥n
2. A√±adir en `docs/patterns/coderabbit-lessons.md`
3. Commit: `docs(patterns): Add CodeRabbit lesson - [patr√≥n]`

---

## üìö Referencias

- PR 805: https://github.com/Eibon7/roastr-ai/pull/805
- Review: https://github.com/Eibon7/roastr-ai/pull/805#pullrequestreview-3447334692
- Issue #774: Pending tests fixes
- Quality Standards: `docs/QUALITY-STANDARDS.md`
- GDD Guide: `docs/GDD-ACTIVATION-GUIDE.md`

---

## ‚ö†Ô∏è IMPORTANTE

1. **COMPLETAR** con comentarios reales de la revisi√≥n CodeRabbit
2. **NO SALTAR** FASE 0
3. **EJECUTAR** comandos reales de verificaci√≥n (no asumir)
4. **MANTENER** mentalidad Calidad > Velocidad
