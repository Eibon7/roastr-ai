# SSOT v2 - Configuración Estática
#
# Este archivo contiene valores estáticos que no cambian en runtime.
# Para valores dinámicos, usar la tabla admin_settings en Supabase.
#
# Prioridad de carga:
# 1. admin_settings (Supabase) - Runtime, dinámico
# 2. admin-controlled.yaml - Build-time, estático
#
# Última actualización: 2025-01-27

# Rate Limiting Configuration (ROA-526, §12.4 SSOT v2)
rate_limit:
  auth:
    # Configuración por tipo de autenticación
    password:
      windowMs: 900000          # 15 minutos
      maxAttempts: 5
      blockDurationMs: 900000   # 15 minutos
    
    magic_link:
      windowMs: 3600000         # 1 hora
      maxAttempts: 3
      blockDurationMs: 3600000  # 1 hora
    
    oauth:
      windowMs: 900000          # 15 minutos
      maxAttempts: 10
      blockDurationMs: 900000   # 15 minutos
    
    password_reset:
      windowMs: 3600000         # 1 hora
      maxAttempts: 3
      blockDurationMs: 3600000  # 1 hora
    
    # Bloqueo progresivo (escalación por reincidencia)
    block_durations:
      - 900000      # 15 minutos (1ra infracción)
      - 3600000     # 1 hora (2da infracción)
      - 86400000    # 24 horas (3ra infracción)
      - null        # Permanente (4ta+ infracción, requiere intervención manual)

# Abuse Detection Configuration (§12.6.5 SSOT v2)
abuse_detection:
  thresholds:
    multi_ip: 3         # Umbral: mismo usuario desde N+ IPs
    multi_email: 5      # Umbral: N+ emails desde misma IP
    burst: 10           # Umbral: N+ intentos en < 1 minuto
    slow_attack: 20     # Umbral: N+ intentos en ventana completa

# Authentication Configuration
auth:
  login:
    enabled: true
  signup:
    enabled: true
  magic_link:
    enabled: true

# Feature Flags (SSOT-driven)
feature_flags:
  enable_user_registration: false
  # Auth endpoint gates (ROA-406, ROA-532)
  auth_enable_login: true
  auth_enable_register: true
  auth_enable_emails: true
  auth_enable_magic_link: false
  auth_enable_password_recovery: false
  auth_enable_oauth: false
  auth_enable_session_refresh: true

# Shield Configuration
shield:
  # Valores por defecto (pueden ser overrideados por admin_settings)
  default_aggressiveness: 0.95
  thresholds:
    critical: 0.95
    high: 0.85
    medium: 0.60
    low: 0.40

# Analysis Configuration
analysis:
  # Límites de caracteres por plataforma
  tweet_max_length: 280
  youtube_comment_max_length: 10000
  instagram_comment_max_length: 2200

  # Límites de análisis (valores por defecto, overrideables por admin_settings)
  max_analysis_per_day: 1000

# Roasting Configuration
roasting:
  # Tonos soportados
  supported_tones:
    - flanders
    - balanceado
    - canalla

  # Configuración de generación
  max_retries: 3
  timeout_seconds: 30

# Platform Constraints
platforms:
  twitter:
    max_length: 280
    supported_actions:
      - mute
      - block
      - report

  youtube:
    max_length: 10000
    supported_actions:
      - hide
      - report

  instagram:
    max_length: 2200
    supported_actions:
      - hide
      - block

# Response Frequency (Cadencias)
response_frequency:
  # Valores en minutos
  options:
    - '5m'
    - '10m'
    - '30m'
    - '1h'
    - '6h'
    - '24h'

  default: '10m'

# Plan Limits (valores por defecto, overrideables por admin_settings)
plans:
  starter:
    monthly_limit: 100
    features:
      - basic_roasting
      - shield_basic

  pro:
    monthly_limit: 500
    features:
      - basic_roasting
      - shield_basic
      - advanced_roasting

  plus:
    monthly_limit: 2000
    features:
      - basic_roasting
      - shield_basic
      - advanced_roasting
      - custom_persona
      - priority_support
